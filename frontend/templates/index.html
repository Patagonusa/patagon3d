<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Patagon3d - AI Renovation Visualizer</title>
    <link rel="stylesheet" href="/static/css/styles.css">
    <!-- Three.js for 3D viewing -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/controls/OrbitControls.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/js/loaders/GLTFLoader.js"></script>
</head>
<body>
    <div class="app-container">
        <!-- Header -->
        <header class="header">
            <div class="logo">
                <img src="/static/images/logo.png" alt="Patagon Consulting" class="logo-image">
            </div>
            <h1 class="app-title">Patagon3d</h1>
            <p class="tagline">AI Renovation Visualizer</p>
            <p class="company">Hello Projects Pro | CSLB #1135440</p>
        </header>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Step 1: Upload Video -->
            <section id="upload-section" class="section active">
                <div class="section-header">
                    <span class="step-number">1</span>
                    <h2>Capture Your Space</h2>
                </div>
                <p class="instruction">Record a video walking around your kitchen or room. Move slowly and capture all angles.</p>

                <div class="upload-area" id="upload-area">
                    <div class="upload-icon">üìπ</div>
                    <p>Tap to record or select video</p>
                    <input type="file" id="video-input" accept="video/*" capture="environment">
                </div>

                <div id="video-preview" class="video-preview hidden">
                    <video id="preview-video" controls></video>
                    <button id="upload-btn" class="btn btn-primary">
                        <span class="btn-icon">‚òÅÔ∏è</span>
                        Upload & Create 3D Model
                    </button>
                </div>

                <div id="upload-progress" class="progress-container hidden">
                    <div class="progress-bar">
                        <div class="progress-fill" id="progress-fill"></div>
                    </div>
                    <p id="progress-text">Uploading...</p>
                </div>
            </section>

            <!-- Step 2: View & Measure 3D Model -->
            <section id="model-section" class="section hidden">
                <div class="section-header">
                    <span class="step-number">2</span>
                    <h2>Measure Your Space</h2>
                </div>

                <div class="model-viewer-container">
                    <div id="model-viewer" class="model-viewer"></div>
                    <div class="viewer-controls">
                        <button class="control-btn" id="rotate-btn" title="Auto Rotate">üîÑ</button>
                        <button class="control-btn" id="reset-btn" title="Reset View">üéØ</button>
                    </div>
                </div>

                <!-- Measurement Toolbar -->
                <div class="measurement-toolbar">
                    <h3>Measurement Tools</h3>
                    <p id="measure-instruction" class="measure-instruction">Select a measurement tool above</p>
                    <div class="measure-buttons">
                        <button class="measure-mode-btn" id="measure-distance-btn">
                            <span class="btn-icon">üìè</span>
                            <span>Distance</span>
                        </button>
                        <button class="measure-mode-btn" id="measure-area-btn">
                            <span class="btn-icon">‚¨õ</span>
                            <span>Area</span>
                        </button>
                        <button class="measure-mode-btn" id="measure-height-btn">
                            <span class="btn-icon">üìê</span>
                            <span>Height</span>
                        </button>
                    </div>
                    <div class="measure-actions">
                        <button class="action-btn" id="calibrate-btn" title="Calibrate measurements">
                            ‚öôÔ∏è Calibrate
                        </button>
                        <button class="action-btn" id="clear-measurements-btn" title="Clear all measurements">
                            üóëÔ∏è Clear All
                        </button>
                        <button class="action-btn" id="export-measurements-btn" title="Export measurements">
                            üì• Export
                        </button>
                    </div>
                </div>

                <!-- Measurements List -->
                <div class="measurement-panel">
                    <h3>Your Measurements</h3>
                    <div id="measurement-summary" class="measurement-summary">
                        <div class="summary-item">
                            <span class="summary-label">Total Area:</span>
                            <span class="summary-value">0 sq ft</span>
                        </div>
                        <div class="summary-item">
                            <span class="summary-label">Total Linear:</span>
                            <span class="summary-value">0' 0"</span>
                        </div>
                        <div class="summary-item">
                            <span class="summary-label">Measurements:</span>
                            <span class="summary-value">0</span>
                        </div>
                    </div>
                    <div id="measurements-list" class="measurements-list">
                        <p class="empty-measurements">No measurements yet</p>
                    </div>
                </div>

                <button id="continue-to-design" class="btn btn-primary">
                    <span class="btn-icon">üé®</span>
                    Continue to AI Design
                </button>
            </section>

            <!-- Calibration Modal -->
            <div id="calibration-modal" class="modal hidden">
                <div class="modal-content">
                    <h3>Calibrate Measurements</h3>
                    <p>Measure a known distance in your model, then enter the real-world measurement to calibrate.</p>
                    <div class="calibration-input">
                        <label for="known-distance">Known distance (feet):</label>
                        <input type="number" id="known-distance" placeholder="e.g., 3.5" step="0.1">
                    </div>
                    <div class="modal-actions">
                        <button class="btn btn-secondary" id="cancel-calibration">Cancel</button>
                        <button class="btn btn-primary" id="apply-calibration">Apply</button>
                    </div>
                </div>
            </div>

            <!-- Step 3: AI Renovation -->
            <section id="design-section" class="section hidden">
                <div class="section-header">
                    <span class="step-number">3</span>
                    <h2>AI Renovation Proposals</h2>
                </div>

                <div class="design-options">
                    <div class="option-group">
                        <label>What would you like to change?</label>
                        <div class="element-buttons">
                            <button class="element-btn" data-element="cabinets">üóÑÔ∏è Cabinets</button>
                            <button class="element-btn" data-element="countertops">‚¨õ Countertops</button>
                            <button class="element-btn" data-element="backsplash">üß± Backsplash</button>
                            <button class="element-btn" data-element="flooring">üü´ Flooring</button>
                            <button class="element-btn" data-element="appliances">üç≥ Appliances</button>
                            <button class="element-btn" data-element="lighting">üí° Lighting</button>
                        </div>
                    </div>

                    <div class="option-group">
                        <label>Describe your vision</label>
                        <textarea id="design-prompt" placeholder="e.g., Modern white shaker cabinets with brushed gold hardware, marble countertops..."></textarea>
                    </div>

                    <div class="style-presets">
                        <p>Quick styles:</p>
                        <div class="preset-buttons">
                            <button class="preset-btn" data-preset="modern">Modern Minimalist</button>
                            <button class="preset-btn" data-preset="farmhouse">Farmhouse Rustic</button>
                            <button class="preset-btn" data-preset="transitional">Transitional</button>
                            <button class="preset-btn" data-preset="contemporary">Contemporary Luxury</button>
                        </div>
                    </div>

                    <button id="generate-design" class="btn btn-primary btn-large">
                        <span class="btn-icon">‚ú®</span>
                        Generate AI Renovation
                    </button>
                </div>

                <div id="ai-results" class="ai-results hidden">
                    <h3>Your Renovation Proposals</h3>
                    <div id="proposals-grid" class="proposals-grid"></div>
                </div>
            </section>

            <!-- Jobs History -->
            <section id="history-section" class="section">
                <div class="section-header">
                    <h2>Recent Scans</h2>
                </div>
                <div id="jobs-list" class="jobs-list"></div>
            </section>
        </main>

        <!-- Footer -->
        <footer class="footer">
            <p>&copy; 2024 Hello Projects Pro | Patagon3d</p>
        </footer>
    </div>

    <script src="/static/js/app.js"></script>
</body>
</html>
